plot(cooks.distance(model))
motors.df$rstd <- rstandard(model)
plot(rstandard(model))
View(motors.df)
row = nrow(motors.df)
up_lim <- max(motors.df$rstd)
dn_lim <- min(motors.df$rstd)
while((up_lim>2 | (dn_lim<(-2))) && (nrow(motors.df)/row) > 0.95){
if(up_lim > abs(dn_lim)) {
cat("Removing Observation ",motors.df[motors.df$rstd==up_lim,1]," with rstandard: ",up_lim,"\n")
motors.df <- motors.df[motors.df$rstd<up_lim,]
}
else {
cat("Removing Observation ",motors.df[motors.df$rstd==dn_lim,1]," with rstandard: ",dn_lim,"\n")
motors.df <- motors.df[motors.df$rstd>dn_lim,]
}
model <- lm(motors.df$MILPGAL ~ motors.df$CYLINDER + motors.df$ACCEL + motors.df$WEIGHT + motors.df$YEAR)
motors.df$rstd <- rstandard(model)
up_lim <- max(motors.df$rstd)
dn_lim <- min(motors.df$rstd)
}
plot(cooks.distance(model))
#plot(model)
summary(model)
motors.df <- read.csv("MOTORS.csv",header = TRUE)
View(motors.df)
motors.df <- na.omit(motors.df) # Omitting NA rows
model <- lm(motors.df$MILPGAL ~ motors.df$CYLINDER + motors.df$ACCEL + motors.df$WEIGHT)
car::vif(model)
# Influential observations :: Cook's distance <1
plot(cooks.distance(model))
motors.df$rstd <- rstandard(model)
plot(rstandard(model))
View(motors.df)
row = nrow(motors.df)
up_lim <- max(motors.df$rstd) # Maximum of R-standard
dn_lim <- min(motors.df$rstd) # Minimum of R-standard
while((up_lim>2 | (dn_lim<(-2))) && (nrow(motors.df)/row) > 0.95){
if(up_lim > abs(dn_lim)) {
cat("Removing Observation ",motors.df[motors.df$rstd==up_lim,1]," with rstandard: ",up_lim,"\n")
motors.df <- motors.df[motors.df$rstd<up_lim,]
}
else {
cat("Removing Observation ",motors.df[motors.df$rstd==dn_lim,1]," with rstandard: ",dn_lim,"\n")
motors.df <- motors.df[motors.df$rstd>dn_lim,]
}
# Model again and re-calculate r-standard
model <- lm(motors.df$MILPGAL ~ motors.df$CYLINDER + motors.df$ACCEL + motors.df$WEIGHT)
motors.df$rstd <- rstandard(model)
up_lim <- max(motors.df$rstd)
dn_lim <- min(motors.df$rstd)
}
plot(cooks.distance(model))
#plot(model)
summary(model)
plot(rstandard(model))
motors.df <- read.csv("MOTORS.csv",header = TRUE)
View(motors.df)
motors.df <- na.omit(motors.df) # Omitting NA rows
# 1. Multi Collinearity :: Condition VIF < 4
# model <- lm(motors.df$MILPGAL ~ motors.df$CYLINDER + motors.df$DISPLACE + motors.df$HORSPWR + motors.df$ACCEL + motors.df$WEIGHT, data=motors.df)
model <- lm(motors.df$MILPGAL ~ motors.df$CYLINDER + motors.df$DISPLACE + motors.df$HORSPWR + motors.df$ACCEL + motors.df$WEIGHT + motors.df$YEAR, data=motors.df)
car::vif(model)
#Removing Displace to build the model again
model <- lm(motors.df$MILPGAL ~ motors.df$CYLINDER + motors.df$HORSPWR + motors.df$ACCEL + motors.df$WEIGHT + motors.df$YEAR)
# model <- lm(motors.df$MILPGAL ~ motors.df$CYLINDER + motors.df$HORSPWR + motors.df$ACCEL + motors.df$WEIGHT)
car::vif(model)
#Removing horsepower to build the model again
model <- lm(motors.df$MILPGAL ~ motors.df$CYLINDER + motors.df$ACCEL + motors.df$WEIGHT + motors.df$YEAR)
car::vif(model)
# Influential observations :: Cook's distance <1
plot(cooks.distance(model))
motors.df$rstd <- rstandard(model)
plot(rstandard(model))
View(motors.df)
row = nrow(motors.df)
up_lim <- max(motors.df$rstd) # Maximum of R-standard
dn_lim <- min(motors.df$rstd) # Minimum of R-standard
while((up_lim>2 | (dn_lim<(-2))) && (nrow(motors.df)/row) > 0.95){
if(up_lim > abs(dn_lim)) {
cat("Removing Observation ",motors.df[motors.df$rstd==up_lim,1]," with rstandard: ",up_lim,"\n")
motors.df <- motors.df[motors.df$rstd<up_lim,]
}
else {
cat("Removing Observation ",motors.df[motors.df$rstd==dn_lim,1]," with rstandard: ",dn_lim,"\n")
motors.df <- motors.df[motors.df$rstd>dn_lim,]
}
# Model again and re-calculate r-standard
model <- lm(motors.df$MILPGAL ~ motors.df$CYLINDER + motors.df$ACCEL + motors.df$WEIGHT + motors.df$YEAR)
motors.df$rstd <- rstandard(model)
up_lim <- max(motors.df$rstd)
dn_lim <- min(motors.df$rstd)
}
plot(rstandard(model))
plot(cooks.distance(model))
#plot(model)
summary(model)
motors.df <- read.csv("MOTORS.csv",header = TRUE)
View(motors.df)
motors.df <- na.omit(motors.df) # Omitting NA rows
# 1. Multi Collinearity :: Condition VIF < 4
# model <- lm(motors.df$MILPGAL ~ motors.df$CYLINDER + motors.df$DISPLACE + motors.df$HORSPWR + motors.df$ACCEL + motors.df$WEIGHT, data=motors.df)
model <- lm(motors.df$MILPGAL ~ motors.df$CYLINDER + motors.df$DISPLACE + motors.df$HORSPWR + motors.df$ACCEL + motors.df$WEIGHT + motors.df$COMPANY, data=motors.df)
car::vif(model)
#Removing Displace to build the model again
model <- lm(motors.df$MILPGAL ~ motors.df$CYLINDER + motors.df$HORSPWR + motors.df$ACCEL + motors.df$WEIGHT + motors.df$COMPANY)
# model <- lm(motors.df$MILPGAL ~ motors.df$CYLINDER + motors.df$HORSPWR + motors.df$ACCEL + motors.df$WEIGHT)
car::vif(model)
#Removing horsepower to build the model again
model <- lm(motors.df$MILPGAL ~ motors.df$CYLINDER + motors.df$ACCEL + motors.df$WEIGHT + motors.df$COMPANY)
car::vif(model)
# Influential observations :: Cook's distance <1
plot(cooks.distance(model))
motors.df$rstd <- rstandard(model)
plot(rstandard(model))
View(motors.df)
row = nrow(motors.df)
up_lim <- max(motors.df$rstd) # Maximum of R-standard
dn_lim <- min(motors.df$rstd) # Minimum of R-standard
while((up_lim>2 | (dn_lim<(-2))) && (nrow(motors.df)/row) > 0.95){
if(up_lim > abs(dn_lim)) {
cat("Removing Observation ",motors.df[motors.df$rstd==up_lim,1]," with rstandard: ",up_lim,"\n")
motors.df <- motors.df[motors.df$rstd<up_lim,]
}
else {
cat("Removing Observation ",motors.df[motors.df$rstd==dn_lim,1]," with rstandard: ",dn_lim,"\n")
motors.df <- motors.df[motors.df$rstd>dn_lim,]
}
# Model again and re-calculate r-standard
model <- lm(motors.df$MILPGAL ~ motors.df$CYLINDER + motors.df$ACCEL + motors.df$WEIGHT + motors.df$COMPANY)
motors.df$rstd <- rstandard(model)
up_lim <- max(motors.df$rstd)
dn_lim <- min(motors.df$rstd)
}
plot(rstandard(model))
plot(cooks.distance(model))
#plot(model)
summary(model)
motors.df <- read.csv("MOTORS.csv",header = TRUE)
View(motors.df)
motors.df <- na.omit(motors.df) # Omitting NA rows
# 1. Multi Collinearity :: Condition VIF < 4
# model <- lm(motors.df$MILPGAL ~ motors.df$CYLINDER + motors.df$DISPLACE + motors.df$HORSPWR + motors.df$ACCEL + motors.df$WEIGHT, data=motors.df)
model <- lm(motors.df$MILPGAL ~ motors.df$CYLINDER + motors.df$DISPLACE + motors.df$HORSPWR + motors.df$ACCEL + motors.df$WEIGHT + motors.df$COUNTRY, data=motors.df)
car::vif(model)
#Removing Displace to build the model again
model <- lm(motors.df$MILPGAL ~ motors.df$CYLINDER + motors.df$HORSPWR + motors.df$ACCEL + motors.df$WEIGHT + motors.df$COUNTRY)
# model <- lm(motors.df$MILPGAL ~ motors.df$CYLINDER + motors.df$HORSPWR + motors.df$ACCEL + motors.df$WEIGHT)
car::vif(model)
#Removing horsepower to build the model again
model <- lm(motors.df$MILPGAL ~ motors.df$CYLINDER + motors.df$ACCEL + motors.df$WEIGHT + motors.df$COUNTRY)
car::vif(model)
# Influential observations :: Cook's distance <1
plot(cooks.distance(model))
motors.df$rstd <- rstandard(model)
plot(rstandard(model))
View(motors.df)
row = nrow(motors.df)
up_lim <- max(motors.df$rstd) # Maximum of R-standard
dn_lim <- min(motors.df$rstd) # Minimum of R-standard
while((up_lim>2 | (dn_lim<(-2))) && (nrow(motors.df)/row) > 0.95){
if(up_lim > abs(dn_lim)) {
cat("Removing Observation ",motors.df[motors.df$rstd==up_lim,1]," with rstandard: ",up_lim,"\n")
motors.df <- motors.df[motors.df$rstd<up_lim,]
}
else {
cat("Removing Observation ",motors.df[motors.df$rstd==dn_lim,1]," with rstandard: ",dn_lim,"\n")
motors.df <- motors.df[motors.df$rstd>dn_lim,]
}
# Model again and re-calculate r-standard
model <- lm(motors.df$MILPGAL ~ motors.df$CYLINDER + motors.df$ACCEL + motors.df$WEIGHT + motors.df$COUNTRY)
motors.df$rstd <- rstandard(model)
up_lim <- max(motors.df$rstd)
dn_lim <- min(motors.df$rstd)
}
plot(rstandard(model))
plot(cooks.distance(model))
#plot(model)
summary(model)
plot(rstandard(model))
motors.df <- read.csv("MOTORS.csv",header = TRUE)
View(motors.df)
motors.df <- na.omit(motors.df) # Omitting NA rows
# 1. Multi Collinearity :: Condition VIF < 4
# model <- lm(motors.df$MILPGAL ~ motors.df$CYLINDER + motors.df$DISPLACE + motors.df$HORSPWR + motors.df$ACCEL + motors.df$WEIGHT, data=motors.df)
model <- lm(motors.df$MILPGAL ~ motors.df$CYLINDER + motors.df$DISPLACE + motors.df$HORSPWR + motors.df$ACCEL + motors.df$WEIGHT + motors.df$COUNTRY+ motors.df$COMPANY, data=motors.df)
car::vif(model)
#Removing Displace to build the model again
model <- lm(motors.df$MILPGAL ~ motors.df$CYLINDER + motors.df$HORSPWR + motors.df$ACCEL + motors.df$WEIGHT + motors.df$COUNTRY+ motors.df$COMPANY)
# model <- lm(motors.df$MILPGAL ~ motors.df$CYLINDER + motors.df$HORSPWR + motors.df$ACCEL + motors.df$WEIGHT)
car::vif(model)
#Removing horsepower to build the model again
model <- lm(motors.df$MILPGAL ~ motors.df$CYLINDER + motors.df$ACCEL + motors.df$WEIGHT + motors.df$COUNTRY+ motors.df$COMPANY)
car::vif(model)
# Influential observations :: Cook's distance <1
plot(cooks.distance(model))
motors.df$rstd <- rstandard(model)
plot(rstandard(model))
View(motors.df)
row = nrow(motors.df)
up_lim <- max(motors.df$rstd) # Maximum of R-standard
dn_lim <- min(motors.df$rstd) # Minimum of R-standard
while((up_lim>2 | (dn_lim<(-2))) && (nrow(motors.df)/row) > 0.95){
if(up_lim > abs(dn_lim)) {
cat("Removing Observation ",motors.df[motors.df$rstd==up_lim,1]," with rstandard: ",up_lim,"\n")
motors.df <- motors.df[motors.df$rstd<up_lim,]
}
else {
cat("Removing Observation ",motors.df[motors.df$rstd==dn_lim,1]," with rstandard: ",dn_lim,"\n")
motors.df <- motors.df[motors.df$rstd>dn_lim,]
}
# Model again and re-calculate r-standard
model <- lm(motors.df$MILPGAL ~ motors.df$CYLINDER + motors.df$ACCEL + motors.df$WEIGHT + motors.df$COUNTRY + motors.df$COMPANY)
motors.df$rstd <- rstandard(model)
up_lim <- max(motors.df$rstd)
dn_lim <- min(motors.df$rstd)
}
plot(rstandard(model))
plot(cooks.distance(model))
#plot(model)
summary(model)
plot(rstandard(model))
motors.df <- read.csv("MOTORS.csv",header = TRUE)
View(motors.df)
motors.df <- na.omit(motors.df) # Omitting NA rows
# 1. Multi Collinearity :: Condition VIF < 4
# model <- lm(motors.df$MILPGAL ~ motors.df$CYLINDER + motors.df$DISPLACE + motors.df$HORSPWR + motors.df$ACCEL + motors.df$WEIGHT, data=motors.df)
model <- lm(motors.df$MILPGAL ~ motors.df$CYLINDER + motors.df$DISPLACE + motors.df$HORSPWR + motors.df$ACCEL + motors.df$WEIGHT + motors.df$COUNTRY+ motors.df$COMPANY + motors.df$YEAR, data=motors.df)
car::vif(model)
#Removing Displace to build the model again
model <- lm(motors.df$MILPGAL ~ motors.df$CYLINDER + motors.df$HORSPWR + motors.df$ACCEL + motors.df$WEIGHT + motors.df$COUNTRY+ motors.df$COMPANY+motors.df$YEAR)
# model <- lm(motors.df$MILPGAL ~ motors.df$CYLINDER + motors.df$HORSPWR + motors.df$ACCEL + motors.df$WEIGHT)
car::vif(model)
#Removing horsepower to build the model again
model <- lm(motors.df$MILPGAL ~ motors.df$CYLINDER + motors.df$ACCEL + motors.df$WEIGHT + motors.df$COUNTRY+ motors.df$COMPANY+motors.df$YEAR)
car::vif(model)
# Influential observations :: Cook's distance <1
plot(cooks.distance(model))
motors.df$rstd <- rstandard(model)
plot(rstandard(model))
View(motors.df)
row = nrow(motors.df)
up_lim <- max(motors.df$rstd) # Maximum of R-standard
dn_lim <- min(motors.df$rstd) # Minimum of R-standard
while((up_lim>2 | (dn_lim<(-2))) && (nrow(motors.df)/row) > 0.95){
if(up_lim > abs(dn_lim)) {
cat("Removing Observation ",motors.df[motors.df$rstd==up_lim,1]," with rstandard: ",up_lim,"\n")
motors.df <- motors.df[motors.df$rstd<up_lim,]
}
else {
cat("Removing Observation ",motors.df[motors.df$rstd==dn_lim,1]," with rstandard: ",dn_lim,"\n")
motors.df <- motors.df[motors.df$rstd>dn_lim,]
}
# Model again and re-calculate r-standard
model <- lm(motors.df$MILPGAL ~ motors.df$CYLINDER + motors.df$ACCEL + motors.df$WEIGHT + motors.df$COUNTRY + motors.df$COMPANY+motors.df$YEAR)
motors.df$rstd <- rstandard(model)
up_lim <- max(motors.df$rstd)
dn_lim <- min(motors.df$rstd)
}
plot(rstandard(model))
plot(cooks.distance(model))
#plot(model)
summary(model)
plot(rstandard(model))
motors.df <- read.csv("MOTORS.csv",header = TRUE)
View(motors.df)
motors.df <- na.omit(motors.df) # Omitting NA rows
# 1. Multi Collinearity :: Condition VIF < 4
# model <- lm(motors.df$MILPGAL ~ motors.df$CYLINDER + motors.df$DISPLACE + motors.df$HORSPWR + motors.df$ACCEL + motors.df$WEIGHT, data=motors.df)
model <- lm(motors.df$MILPGAL ~ motors.df$CYLINDER + motors.df$DISPLACE + motors.df$HORSPWR + motors.df$ACCEL + motors.df$WEIGHT + motors.df$YEAR, data=motors.df)
car::vif(model)
#Removing Displace to build the model again
model <- lm(motors.df$MILPGAL ~ motors.df$CYLINDER + motors.df$HORSPWR + motors.df$ACCEL + motors.df$WEIGHT + motors.df$YEAR)
# model <- lm(motors.df$MILPGAL ~ motors.df$CYLINDER + motors.df$HORSPWR + motors.df$ACCEL + motors.df$WEIGHT)
car::vif(model)
#Removing horsepower to build the model again
model <- lm(motors.df$MILPGAL ~ motors.df$CYLINDER + motors.df$ACCEL + motors.df$WEIGHT +motors.df$YEAR)
car::vif(model)
# Influential observations :: Cook's distance <1
plot(cooks.distance(model))
motors.df$rstd <- rstandard(model)
plot(rstandard(model))
View(motors.df)
row = nrow(motors.df)
up_lim <- max(motors.df$rstd) # Maximum of R-standard
dn_lim <- min(motors.df$rstd) # Minimum of R-standard
while((up_lim>2 | (dn_lim<(-2))) && (nrow(motors.df)/row) > 0.95){
if(up_lim > abs(dn_lim)) {
cat("Removing Observation ",motors.df[motors.df$rstd==up_lim,1]," with rstandard: ",up_lim,"\n")
motors.df <- motors.df[motors.df$rstd<up_lim,]
}
else {
cat("Removing Observation ",motors.df[motors.df$rstd==dn_lim,1]," with rstandard: ",dn_lim,"\n")
motors.df <- motors.df[motors.df$rstd>dn_lim,]
}
# Model again and re-calculate r-standard
model <- lm(motors.df$MILPGAL ~ motors.df$CYLINDER + motors.df$ACCEL + motors.df$WEIGHT +motors.df$YEAR)
motors.df$rstd <- rstandard(model)
up_lim <- max(motors.df$rstd)
dn_lim <- min(motors.df$rstd)
}
plot(rstandard(model))
plot(cooks.distance(model))
#plot(model)
summary(model)
plot(rstandard(model))
library(ggplot2)
library(car)
library(ggplot2)
motors.df <- read.csv("MOTORS.csv",header = TRUE)
View(motors.df)
motors.df <- na.omit(motors.df) # Omitting NA rows
ggplot(motors.df, aes(x = MILPGAL, y = COMPANY, fill = COMPANY)) + geom_boxplot()
ggplot(motors.df, aes(x = COMPANY, y = MILPGAL, fill = COMPANY)) + geom_boxplot()
library(ggplot2)
?boxplot
boxplot(motors.df$MILPGAL~motors.df$COMPANY)
library(car)
library(ggplot2)
motors.df <- read.csv("MOTORS.csv",header = TRUE)
View(motors.df)
motors.df <- na.omit(motors.df) # Omitting NA rows
motors.df = motors.df[motors.df$COMPANY==1,]
# 1. Multi Collinearity :: Condition VIF < 4
# model <- lm(motors.df$MILPGAL ~ motors.df$CYLINDER + motors.df$DISPLACE + motors.df$HORSPWR + motors.df$ACCEL + motors.df$WEIGHT, data=motors.df)
model <- lm(motors.df$MILPGAL ~ motors.df$CYLINDER + motors.df$DISPLACE + motors.df$HORSPWR + motors.df$ACCEL + motors.df$WEIGHT + motors.df$YEAR, data=motors.df)
car::vif(model)
#Removing Displace to build the model again
model <- lm(motors.df$MILPGAL ~ motors.df$CYLINDER + motors.df$HORSPWR + motors.df$ACCEL + motors.df$WEIGHT + motors.df$YEAR)
# model <- lm(motors.df$MILPGAL ~ motors.df$CYLINDER + motors.df$HORSPWR + motors.df$ACCEL + motors.df$WEIGHT)
car::vif(model)
#Removing horsepower to build the model again
model <- lm(motors.df$MILPGAL ~ motors.df$CYLINDER + motors.df$ACCEL + motors.df$WEIGHT +motors.df$YEAR)
car::vif(model)
# Influential observations :: Cook's distance <1
plot(cooks.distance(model))
motors.df$rstd <- rstandard(model)
plot(rstandard(model))
View(motors.df)
row = nrow(motors.df)
up_lim <- max(motors.df$rstd) # Maximum of R-standard
dn_lim <- min(motors.df$rstd) # Minimum of R-standard
while((up_lim>2 | (dn_lim<(-2))) && (nrow(motors.df)/row) > 0.95){
if(up_lim > abs(dn_lim)) {
cat("Removing Observation ",motors.df[motors.df$rstd==up_lim,1]," with rstandard: ",up_lim,"\n")
motors.df <- motors.df[motors.df$rstd<up_lim,]
}
else {
cat("Removing Observation ",motors.df[motors.df$rstd==dn_lim,1]," with rstandard: ",dn_lim,"\n")
motors.df <- motors.df[motors.df$rstd>dn_lim,]
}
# Model again and re-calculate r-standard
model <- lm(motors.df$MILPGAL ~ motors.df$CYLINDER + motors.df$ACCEL + motors.df$WEIGHT +motors.df$YEAR)
motors.df$rstd <- rstandard(model)
up_lim <- max(motors.df$rstd)
dn_lim <- min(motors.df$rstd)
}
plot(rstandard(model))
plot(cooks.distance(model))
#plot(model)
summary(model)
plot(rstandard(model))
library(car)
library(ggplot2)
motors.df <- read.csv("MOTORS.csv",header = TRUE)
View(motors.df)
motors.df <- na.omit(motors.df) # Omitting NA rows
motors.df = motors.df[motors.df$COMPANY!=1,]
# 1. Multi Collinearity :: Condition VIF < 4
# model <- lm(motors.df$MILPGAL ~ motors.df$CYLINDER + motors.df$DISPLACE + motors.df$HORSPWR + motors.df$ACCEL + motors.df$WEIGHT, data=motors.df)
model <- lm(motors.df$MILPGAL ~ motors.df$CYLINDER + motors.df$DISPLACE + motors.df$HORSPWR + motors.df$ACCEL + motors.df$WEIGHT + motors.df$YEAR, data=motors.df)
car::vif(model)
#Removing Displace to build the model again
model <- lm(motors.df$MILPGAL ~ motors.df$CYLINDER + motors.df$HORSPWR + motors.df$ACCEL + motors.df$WEIGHT + motors.df$YEAR)
# model <- lm(motors.df$MILPGAL ~ motors.df$CYLINDER + motors.df$HORSPWR + motors.df$ACCEL + motors.df$WEIGHT)
car::vif(model)
#Removing horsepower to build the model again
model <- lm(motors.df$MILPGAL ~ motors.df$CYLINDER + motors.df$ACCEL + motors.df$WEIGHT +motors.df$YEAR)
car::vif(model)
# Influential observations :: Cook's distance <1
plot(cooks.distance(model))
motors.df$rstd <- rstandard(model)
plot(rstandard(model))
View(motors.df)
row = nrow(motors.df)
up_lim <- max(motors.df$rstd) # Maximum of R-standard
dn_lim <- min(motors.df$rstd) # Minimum of R-standard
while((up_lim>2 | (dn_lim<(-2))) && (nrow(motors.df)/row) > 0.95){
if(up_lim > abs(dn_lim)) {
cat("Removing Observation ",motors.df[motors.df$rstd==up_lim,1]," with rstandard: ",up_lim,"\n")
motors.df <- motors.df[motors.df$rstd<up_lim,]
}
else {
cat("Removing Observation ",motors.df[motors.df$rstd==dn_lim,1]," with rstandard: ",dn_lim,"\n")
motors.df <- motors.df[motors.df$rstd>dn_lim,]
}
# Model again and re-calculate r-standard
model <- lm(motors.df$MILPGAL ~ motors.df$CYLINDER + motors.df$ACCEL + motors.df$WEIGHT +motors.df$YEAR)
motors.df$rstd <- rstandard(model)
up_lim <- max(motors.df$rstd)
dn_lim <- min(motors.df$rstd)
}
plot(rstandard(model))
plot(cooks.distance(model))
#plot(model)
summary(model)
plot(rstandard(model))
library(car)
library(ggplot2)
motors.df <- read.csv("MOTORS.csv",header = TRUE)
View(motors.df)
motors.df <- na.omit(motors.df) # Omitting NA rows
motors.df = motors.df[motors.df$COMPANY==1,]
# 1. Multi Collinearity :: Condition VIF < 4
# model <- lm(motors.df$MILPGAL ~ motors.df$CYLINDER + motors.df$DISPLACE + motors.df$HORSPWR + motors.df$ACCEL + motors.df$WEIGHT, data=motors.df)
model <- lm(motors.df$MILPGAL ~ motors.df$CYLINDER + motors.df$DISPLACE + motors.df$HORSPWR + motors.df$ACCEL + motors.df$WEIGHT + motors.df$YEAR, data=motors.df)
car::vif(model)
#Removing Displace to build the model again
model <- lm(motors.df$MILPGAL ~ motors.df$CYLINDER + motors.df$HORSPWR + motors.df$ACCEL + motors.df$WEIGHT + motors.df$YEAR)
# model <- lm(motors.df$MILPGAL ~ motors.df$CYLINDER + motors.df$HORSPWR + motors.df$ACCEL + motors.df$WEIGHT)
car::vif(model)
#Removing horsepower to build the model again
model <- lm(motors.df$MILPGAL ~ motors.df$CYLINDER + motors.df$ACCEL + motors.df$WEIGHT +motors.df$YEAR)
car::vif(model)
# Influential observations :: Cook's distance <1
plot(cooks.distance(model))
motors.df$rstd <- rstandard(model)
plot(rstandard(model))
View(motors.df)
row = nrow(motors.df)
up_lim <- max(motors.df$rstd) # Maximum of R-standard
dn_lim <- min(motors.df$rstd) # Minimum of R-standard
while((up_lim>2 | (dn_lim<(-2))) && (nrow(motors.df)/row) > 0.95){
if(up_lim > abs(dn_lim)) {
cat("Removing Observation ",motors.df[motors.df$rstd==up_lim,1]," with rstandard: ",up_lim,"\n")
motors.df <- motors.df[motors.df$rstd<up_lim,]
}
else {
cat("Removing Observation ",motors.df[motors.df$rstd==dn_lim,1]," with rstandard: ",dn_lim,"\n")
motors.df <- motors.df[motors.df$rstd>dn_lim,]
}
# Model again and re-calculate r-standard
model <- lm(motors.df$MILPGAL ~ motors.df$CYLINDER + motors.df$ACCEL + motors.df$WEIGHT +motors.df$YEAR)
motors.df$rstd <- rstandard(model)
up_lim <- max(motors.df$rstd)
dn_lim <- min(motors.df$rstd)
}
plot(rstandard(model))
plot(cooks.distance(model))
#plot(model)
summary(model)
plot(rstandard(model))
library(car)
library(ggplot2)
motors.df <- read.csv("MOTORS.csv",header = TRUE)
View(motors.df)
motors.df <- na.omit(motors.df) # Omitting NA rows
motors.df$COMPANY[motors.df$COMPANY!=1,] <- 2
library(car)
library(ggplot2)
motors.df <- read.csv("MOTORS.csv",header = TRUE)
View(motors.df)
motors.df <- na.omit(motors.df) # Omitting NA rows
motors.df$COMPANY[motors.df$COMPANY!=1] <- 2
boxplot(motors.df$MILPGAL~motors.df$COMPANY)
library(car)
library(ggplot2)
motors.df <- read.csv("MOTORS.csv",header = TRUE)
View(motors.df)
motors.df <- na.omit(motors.df) # Omitting NA rows
boxplot(motors.df$MILPGAL~motors.df$COMPANY)
library(car)
motors.df <- read.csv("MOTORS.csv",header = TRUE)
View(motors.df)
motors.df <- na.omit(motors.df) # Omitting NA rows
boxplot(motors.df$MILPGAL~motors.df$COMPANY) # Boxplot of MILPGAL
# 1. Multi Collinearity :: Condition VIF < 4
model <- lm(motors.df$MILPGAL ~ motors.df$CYLINDER + motors.df$DISPLACE + motors.df$HORSPWR + motors.df$ACCEL + motors.df$WEIGHT + motors.df$YEAR, data=motors.df)
car::vif(model)
#Removing Displace to build the model again
model <- lm(motors.df$MILPGAL ~ motors.df$CYLINDER + motors.df$HORSPWR + motors.df$ACCEL + motors.df$WEIGHT + motors.df$YEAR)
car::vif(model)
#Removing horsepower to build the model again
model <- lm(motors.df$MILPGAL ~ motors.df$CYLINDER + motors.df$ACCEL + motors.df$WEIGHT +motors.df$YEAR)
car::vif(model)
# Influential observations :: Cook's distance <1
plot(cooks.distance(model))
# Creating a new coloumn to track r-standard values
motors.df$rstd <- rstandard(model)
plot(rstandard(model))
row = nrow(motors.df)
up_lim <- max(motors.df$rstd) # Maximum of R-standard
dn_lim <- min(motors.df$rstd) # Minimum of R-standard
while((up_lim>2 | (dn_lim<(-2))) && (nrow(motors.df)/row) > 0.95){
if(up_lim > abs(dn_lim)) {
cat("Removing Observation ",motors.df[motors.df$rstd==up_lim,1]," with rstandard: ",up_lim,"\n")
motors.df <- motors.df[motors.df$rstd<up_lim,]
}
else {
cat("Removing Observation ",motors.df[motors.df$rstd==dn_lim,1]," with rstandard: ",dn_lim,"\n")
motors.df <- motors.df[motors.df$rstd>dn_lim,]
}
# Model again and re-calculate r-standard
model <- lm(motors.df$MILPGAL ~ motors.df$CYLINDER + motors.df$ACCEL + motors.df$WEIGHT +motors.df$YEAR)
motors.df$rstd <- rstandard(model)
up_lim <- max(motors.df$rstd)
dn_lim <- min(motors.df$rstd)
}
plot(rstandard(model))
plot(cooks.distance(model))
plot(model)
summary(model)
